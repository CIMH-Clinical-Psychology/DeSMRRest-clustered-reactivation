<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="DESCRIPTION META TAG">
  <meta property="og:title" content="SOCIAL MEDIA TITLE TAG"/>
  <meta property="og:description" content="SOCIAL MEDIA DESCRIPTION TAG TAG"/>
  <meta property="og:url" content="URL OF THE WEBSITE"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="TWITTER BANNER TITLE META TAG">
  <meta name="twitter:description" content="TWITTER BANNER DESCRIPTION META TAG">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="KEYWORDS SHOULD BE PLACED HERE">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Paper: Challenges in Replay Detection by TDLM in Post-Encoding Resting State</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Experiment Visualization for "Challenges in Replay Detection by TDLM in Post-Encoding Resting State"</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://skjerns.de" target="_blank">Simon Kern</a><sup>*</sup>,</span>
				<a href="https://juli-nagel.de" target="_blank">Juliane Nagel</a>,</span>
				<a href="https://lennartwittkuhn.com" target="_blank">Lennart Wittkuhn</a>,</span>
				<a href="https://gaislab.info" target="_blank">Steffen Gais</a>,</span>
				<a href="https://scholar.google.co.uk/citations?user=RP8YtJgAAAAJ&hl=en" target="_blank">Raymond J Dolan</a>,</span>
				<a href="https://scholar.google.de/citations?user=na6A-zkAAAAJ&hl=en" target="_blank">Gordon B Feld</a>,</span>
                <span class="author-block">

                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block">Central Institute of Mental Health<br></span>,
                    <span class="author-block">University of Hamburg<br></span>,
                    <span class="author-block">University of Tübingen<br></span>,
                    <span class="author-block">UCL<br></span>
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- Arxiv PDF link -->
                      <span class="link-block">
                        <a href="https://arxiv.org/pdf/<ARXIV PAPER ID>.pdf" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/CIMH-Clinical-Psychology/DeSMRRest-TDLM-Simulation" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <!-- ArXiv abstract Link -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/<ARXIV PAPER ID>" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>

We investigated, using temporally delayed linear modelling (TDLM) and magnetoencephalography (MEG), whether items associated with an underlying graph structure are replayed during a post-learning resting state. In these same data, we have previously provided evidence for replay during on-line (non-rest) memory retrieval. Despite successful decoding of brain activity during a localizer task, and contrary to predictions, we did not detect evidence for replay during a post-learning resting state. To better understand this, we performed a hybrid simulation analysis in which we inserted synthetic replay events into a control resting state recorded prior to the actual experiment. This simulation revealed that replay detection using our current pipeline requires extremely high replay densities to reach significance (>1 replay sequence per second, with “replay” defined as a sequence of reactivations within a certain time lag). Furthermore, when scaling the number of replay events with a behavioural measure we were unable to experimentally induce a strong correlation between sequenceness and this measure. We infer that even if replay was present at plausible rates in our resting state dataset we would lack statistical power to detect it with TDLM. We discuss ways for optimizing the analysis approach and how to find boundary conditions under which TDLM can be expected to detect replay successfully. We conclude that solving these methodological constraints is likely to be crucial to optimise measuring replay non-invasively using MEG in humans.
			</p>
			
<a href="#results-summary" style="color: lightblue; text-decoration: underline;">Jump to Results Summary</a>        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<!--  -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Experiment overview</h2>
        <div class="content has-text-justified">
		        <img src="./images/overview.png"/>

          <p>
		  All parts of the experiment were run in an MEG while recording. The general structure of the experiment was:
			</p>
			<ol>
			  <li>Control Resting State (8 minutes eyes closed)</li>
			  <li>Localizer (10 images in 500 trials)</li>
			  <li>Learning Block (2-6 blocks of 12 trials)</li>
			  <li>Resting State (8 minutes eyes closed)</li>
			  <li>Retrieval (1 block of 12 trials)</li>
			</ol>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- -->
<details closed class="is-centered has-text-centered hero is-light">
<summary class="title is-3" style="cursor:pointer;"><u>Click to expand paradigm details</u></summary>

<!-- RESTING STATE -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-4">1. Control Resting State</h2>
        <div class="content has-text-justified">
          <p>
		  An 8-minute resting state was measured, participants instructed to close their eyes and to not think of anything in particular. Data of this session was later used for basis of the hybrid simulation.
	</p>
        <img src="./images/restingstate.gif"/>

        </div>
      </div>
    </div>
  </div>
</section>
<!-- -->

<!-- LOCALIZER -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-4">2. Localizer</h2>
        <div class="content has-text-justified">
          <p>
10 images, diverse in color&shape were presented to participants. 
First the word belonging to the image was presented auditorily, then either a matching or non-matching image was shown.
participants were instructed to press a button in case of mismatch (attention check). This data was later used to train a classifier on these images.
	</p>
    <p>In total, 500 such trials were recorded, with 60 trials being mismatches</p>

	        <img src="./images/stimuli.png" alt="all 10 stimuli visualized"/>
<p>Video of screen during localizer (click to play, with audio)</p>
<div is-centered >
          <video poster="" id="video3" autoplay controls loop height="100%">\
            <!-- Your video file here -->
            <source src="./images/presentation_localizer.mp4"
            type="video/mp4">
          </video>
		  </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- -->

<!-- LEARNING -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-4">3. Learning</h2>
        <div class="content has-text-justified">
          <p>
The ten images were embedded into a graph structure. 
The graph had duplicates such that participants could not rely on simple pair-wise 
learning but needed to learn triplets/surrounding. Participants never 
	</p>
	<p>Participants performed blocks until they reached 80% correct trials. 
	Regardless, they performed a minimum of 2 and a maximum of 6 blocks.</p>
	<p>Here's a top-down view of the sequence (participants were never told about this hidden structure)</p>


	        <img src="./images/sequence.png" alt="all 10 stimuli visualized"/>
<p>GIF of screen during learning block</p>
	        <img src="./images/learning.gif" alt="sequence learning"/>

        </div>
      </div>
    </div>
  </div>
</section>
<!-- -->

<!-- RESTING STATE -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-4">4. Post-Learning Resting State</h2>
        <div class="content has-text-justified">
          <p>
		  Another 8-minute resting state was measured, in which we expected consolidation of the learned material.
	</p>
        <img src="./images/restingstate.gif"/>

        </div>
      </div>
    </div>
  </div>
</section>
<!-- -->


<!-- RETRIEVAl -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-4">5. Retrieval</h2>
        <div class="content has-text-justified">
	<p>One block of 12 trials (each sequence position once) was shown to test retrieval performance after resting state. No feedback was provided during this block.</p>

<p>GIF of screen during retrieval block</p>
	        <img src="./images/retrieval.gif" alt="sequence learning"/>

        </div>
      </div>
    </div>
  </div>
</section>
  </details open>

<!-- -->
		
<!-------------->
<!-- RESULTS  -->
<!-------------->
<br>
<br>
<br>
<h1 class="title is-1 publication-title hero is-centered has-text-centered" id="results-summary">Results summary</h1>

<!-- STUDY 1 -->
<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3 is-centered has-text-centered">Study 1: No replay found in post-learning rest</h2>

    <!-- Localizer subsection -->
    <h3 class="title is-4 is-centered has-text-centered">Localizer: Robust Decoders</h3>
	    <div class="content">

    <p class="content">We determined the timepoint of best decoding accuracy by running a cross-validation across time. Peak decoding accuracy was at <strong>42 % accuracy (chance = 10 %)</strong> at <strong>210 milliseconds </strong>after stimulus onset. We trained one logistic regression classifier per class per participant on data from that timepoint (one-vs-all classification).</p>
    <figure>
      <img src="./images/figure_localizer.png" alt="Classifier performance across participants" style="max-width:100%">
	  <figcaption>Figure 1 Left: Memory performance of participants per block. Middle: Decoding accuracy for each item (chance = 10%) across time. Error bars show ±1 SEM. Right: Decoding heatmap for training at specific time point and testing on another.</figcaption>
	<figure>


      <h3 class="title is-4 is-centered has-text-centered">No Sequenceness During Post‑Learning Rest</h3>
      <p>We applied the trained decoders to the control resting state and the post-learning resting state, expecting replay of sequences to occur during post-learning resting state. The result (a probability estimate of each 10 images/classes for each time point of the resting state) was fed into TDLM to detect sequentiality of reactivations. However, we found <strong>no forward or backward sequenceness</strong> within either 8-minute resting state</p>
      <figure>
        <img src="./images/sequenceness-rs.png" alt="Sequenceness curves" style="max-width:100%">
        <figcaption>Figure 2. Forward (orange) and backward (green) sequenceness traces stay within the permutation confidence envelope for both control and post-learning resting state.</figcaption>
      </figure>
    </div>
  </div>
</section>

<!-- ================= Study 2 ================= -->
<section class="section has-background-light">
  <div class="container is-max-desktop">
    <h2 class="title is-3 is-centered has-text-centered">Study 2: Hybrid Simulation</h2>

    <!-- Simulated replay subsection -->
    <div class="content">
      <h3 class="title is-4 is-centered has-text-centered">Simulated Replay Insertion</h3>
      <p>We extracted activity patterns for each item by creating the average ERP of each item and subtraced the ERP of all other items. Using this process we were able to get the <strong>subtle item-specific pattern</strong> minus the visual evoked potential that is common to general visual processing. We inserted these momentary patterns (each spanning ~10 ms) into the control resting state.</p>
      <figure>
        <img src="./images/schematic-simulation.png" alt="Replay insertion schematic" style="max-width:100%">
        <figcaption><em>Figure&nbsp;3.</em> Schematic of replay event generation and embedding into MEG data.</figcaption>
      </figure>
    </div>

    <!-- Implausible rates subsection -->
    <div class="content">
      <h3 class="title is-4 is-centered has-text-centered">Implausibly High Replay Rates Required</h3>
      <p>Next we varied the amount of replay that was inserted into the resting state. We started with a baseline of zero replay events and scaled up to a normalized "replay rate" of 200 events per minute, where each "event" was defined as a transition of A->B.
	  
	  TDLM reached 95% detection power only when replay density exceeded <strong>≥80 events per minute</strong> (≈1.3&nbsp;Hz)—an order of magnitude above hippocampal sharp‑wave ripple rates (usually ~2–3 min per minute, reported up to 20 events per minute).</p>
      <figure>
        <img src="./images/simulation-results.png" alt="Power curve vs replay rate" style="max-width:100%">
        <figcaption>Figure 4. Left: Statistical significance of TDLM as a function of injected replay rate. Only with 80 events per minute significance can be reached, more stringend criterias only at 150 events per minute. Right: 4 sample curves for density of 0, 40, 80 and 120 events per minute</figcaption>
      </figure>
    </div>

    <!-- Correlation subsection -->
    <div class="content">
      <h3 class="title is-4 is-centered has-text-centered">Behaviour ≠ Sequenceness</h3>
      <p>Some studies correlate sequenceness measures with behavioural measures. We simulated this dependency by scaling replay counts with each participant’s retrieval performance. However, this produced <strong>no reliable correlation</strong>. present, TDLM failed to track individual memory strength, as the fluctuation between participants baseline scores was already higher than any induced effect.</p>
      <figure>
        <img src="./images/correlation.png" alt="Correlation scatter" style="max-width:100%">
        <figcaption>Figure 5. Left: When inserting more replay for participants with lower memory performance (green), no correlation can be induced. Only when maximizing the scaling rule (blue) and inserting no replay for the best and maximum replay for the worst participants, correlations are found at 200 events per minute. Right: Even in the baseline condition (with no replay inserted), the correlation fluctuates significantly based upon which time point is used for it's computation.</figcaption>
      </figure>
    </div>

<!-- ================= Previous Simulation Work ================= -->
    <div class="content">
	    <h3 class="title is-4 is-centered has-text-centered">Previous Simulations Overestimate Replay</h2>
      <p>Previously TDLM simulations often demonstrated significant sequenceness by injecting <strong>2000–2400 events per minute</strong>, two orders of magnitude above in-vivo estimates. Our replication of these defaults confirms that such extreme densities virtually guarantee significance, potentially setting unrealistic expectations for empirical work. Indeed, when using the original simulation code and injecting a more realistic estimate of 15 events per minute, significance is barely reached. In the original study, purely synthetic data is used to simulate replay. We argue that our approach approximates naturalistic conditions more closely.</p>
      <figure>
        <img src="./images/tdlm-sim.png" alt="Legacy simulation outcomes" style="max-width:100%">
        <figcaption><em>Figure 6.</em> Upper: Legacy simulations (above) with 2000 events per minute. Lower: The same code run with more realistic estimate of 15 events per minute barely reaches significance.</figcaption>
      </figure>
  </div>

<!-- ================= Recommendations ================= -->
  <div class="container is-max-desktop">
    <h2 class="title is-3 is-centered has-text-centered">Conclusion and Recommendation</h2>
	<p>In our study we showed that TDLM was not able to detect replay in our experimental setup. Using a hybrid simulation approach we varied the amount of replay and found that implausible rates would be necessary for detection. However, in certain contexts TDLM should nevertheless work well (e.g. limited search windows). To be applicable to longer search windows (eg sleep & resting state), methodological improvements need to be implemented and verified.</p>
	<br>
	Additionally, we give the following recommendations for future replay studies:
    <ul">
      <li><strong>Anchor and report replay‑rate priors</strong> to SWR literature (≤20 events min<sup>−1</sup>).</li>
      <li>Simulate if found replay rates could be reliably found</li>
      <li><em>Preregister</em> temporal windows and decoder normalisation choices.</li>
      <li>Run <em>multiverse analyses</em> to reveal parameter dependencies.</li>
	  <li>Subselect ROIs of few seconds for reliable detection, e.g. locked to oscillations</li>

    </ul>
  </div>
</section>


<!-- -->
  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
